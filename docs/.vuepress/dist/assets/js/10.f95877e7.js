(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{279:function(t,a,e){"use strict";e.r(a);var r=e(13),s=Object(r.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#介绍"}},[t._v("#")]),t._v(" 介绍")]),t._v(" "),a("p",{attrs:{align:"left"}},[a("a",{attrs:{href:"https://github.com/tj/commander.js"}},[a("img",{attrs:{src:"https://img.shields.io/badge/commander-8.3.0-brightgreen",alt:"commander"}})]),t._v(" "),a("a",{attrs:{href:"https://github.com/SBoudrias/Inquirer.js"}},[a("img",{attrs:{src:"https://img.shields.io/badge/Inquirer-8.2.0-orange",alt:"Inquirer"}})]),t._v(" "),a("a",{attrs:{href:"https://github.com/metalsmith/metalsmith",rel:"nofollow"}},[a("img",{attrs:{src:"https://img.shields.io/badge/metalsmith-2.5.0-blue",alt:"metalsmith"}})]),t._v(" "),a("a",{attrs:{href:"https://github.com/kevva/download",rel:"nofollow"}},[a("img",{attrs:{src:"https://img.shields.io/badge/download-7.1.0-critical",alt:"download"}})]),t._v(" "),a("a",{attrs:{href:"https://github.com/tj/consolidate.js"}},[a("img",{attrs:{src:"https://img.shields.io/badge/consolidate-0.16.0-ff69b4",alt:"consolidate"}})])]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("p",[t._v("你一定在开发中遇到过这样的场景")]),t._v(" "),a("ul",[a("li",[a("ol",[a("li",[t._v("开发子应用的时候，每次要更换内部关于本应用的配置，但经常会漏掉一些")])])]),t._v(" "),a("li",[a("ol",{attrs:{start:"2"}},[a("li",[t._v("子应用中公共的部分要改的时候，要同步到所有子应用")])])]),t._v(" "),a("li",[a("ol",{attrs:{start:"3"}},[a("li",[t._v("创建新的子应用时，从另一个子应用复制过来，增删一些代码，相当繁琐")])])])])]),t._v(" "),a("h2",{attrs:{id:"功能"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#功能"}},[t._v("#")]),t._v(" 功能")]),t._v(" "),a("p",[t._v("脚手架主要解决两个方面的痛点：")]),t._v(" "),a("ol",[a("li",[t._v("维护一套子应用模板，使得子应用迭代可控")]),t._v(" "),a("li",[t._v("生成项目的时候，根据用户输入，替换好所有变量")])]),t._v(" "),a("h2",{attrs:{id:"开发"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#开发"}},[t._v("#")]),t._v(" 开发")]),t._v(" "),a("p",[t._v("脚手架的思路是：")]),t._v(" "),a("p",[t._v("1.从仓库拉取模板代码")]),t._v(" "),a("p",[t._v("2.遍历文件进行变量替换")]),t._v(" "),a("p",[t._v("基础的功能参考 👉 "),a("a",{attrs:{href:"https://juejin.cn/post/6966119324478079007#heading-1",target:"_blank",rel:"noopener noreferrer"}},[t._v("从 0 构建自己的脚手架/CLI知识体系（万字） 🛠"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("在此基础上，我们还需扩展一点功能，以支撑我们自己的业务")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("- 支持gitlab自建仓库\n- 替换模板中的变量\n")])])]),a("h3",{attrs:{id:"支持gitlab自建仓库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#支持gitlab自建仓库"}},[t._v("#")]),t._v(" 支持gitlab自建仓库")]),t._v(" "),a("p",[t._v("这里我们需要用到 gitlab restful api，")]),t._v(" "),a("ul",[a("li",[t._v("👉 "),a("a",{attrs:{href:"https://docs.gitlab.com/ee/api/groups.html#list-a-groups-projects",target:"_blank",rel:"noopener noreferrer"}},[t._v("获取gitlab某个组下的所有仓库列表"),a("OutboundLink")],1)]),t._v(" "),a("li",[t._v("👉 "),a("a",{attrs:{href:"https://docs.gitlab.com/ee/api/branches.html#list-repository-branches",target:"_blank",rel:"noopener noreferrer"}},[t._v("获取gitlab某个项目的所有分支"),a("OutboundLink")],1)])]),t._v(" "),a("p",[t._v("为请求到这两个接口，我们还需几步")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("生成token：\n\n- 点击右上角个人信息，选择Preference，左边菜单就可以看到Access Token\n\n- 选择所需的能力，生成token\n\n配置：\n\n- 将token配置到 zove/lib/utils/store\n\n- 配置GitlabBaseUrl 和 GitlabGroupId，分别是gitlab的 【域名】 和 【分组id】\n\n")])])]),a("h3",{attrs:{id:"替换模板中的变量"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#替换模板中的变量"}},[t._v("#")]),t._v(" 替换模板中的变量")]),t._v(" "),a("p",[t._v("这里主要用到"),a("a",{attrs:{href:"https://github.com/metalsmith/metalsmith",target:"_blank",rel:"noopener noreferrer"}},[t._v("metalsmith"),a("OutboundLink")],1),t._v("和"),a("a",{attrs:{href:"https://github.com/tj/consolidate.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("consolidate"),a("OutboundLink")],1),t._v("这两个工具")]),t._v(" "),a("p",[t._v("递归地遍历下载好的模板，替换模板中匹配到的变量（ejs的语法，如：<%= var %>）")]),t._v(" "),a("p",[t._v("这样，我们在模板中想要更换的变量只用写到配置文件中，创建项目时根据询问填写即可")]),t._v(" "),a("p",[t._v("（"),a("em",[t._v("也有一种做法是从项目中读取配置文件，这就需要我们将配置文件写到项目中")]),t._v("）")]),t._v(" "),a("h2",{attrs:{id:"使用到的插件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用到的插件"}},[t._v("#")]),t._v(" 使用到的插件")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("插件")]),t._v(" "),a("th",[t._v("描述")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("commander")]),t._v(" "),a("td",[t._v("命令行自定义指令")])]),t._v(" "),a("tr",[a("td",[t._v("inquirer")]),t._v(" "),a("td",[t._v("命令行询问用户问题，记录回答结果")])]),t._v(" "),a("tr",[a("td",[t._v("chalk")]),t._v(" "),a("td",[t._v("控制台输出内容样式美化")])]),t._v(" "),a("tr",[a("td",[t._v("ora")]),t._v(" "),a("td",[t._v("控制台 loading 样式")])]),t._v(" "),a("tr",[a("td",[t._v("figlet")]),t._v(" "),a("td",[t._v("控制台打印 logo")])]),t._v(" "),a("tr",[a("td",[t._v("boxen")]),t._v(" "),a("td",[t._v("控制台打印特殊样式")])]),t._v(" "),a("tr",[a("td",[t._v("download")]),t._v(" "),a("td",[t._v("下载远程模板")])]),t._v(" "),a("tr",[a("td",[t._v("fs-extra")]),t._v(" "),a("td",[t._v("操作文件，支持promise")])]),t._v(" "),a("tr",[a("td",[t._v("minimist")]),t._v(" "),a("td",[t._v("命令行参数解析")])]),t._v(" "),a("tr",[a("td",[t._v("leven")]),t._v(" "),a("td",[t._v("测量两字符串之间的差异")])]),t._v(" "),a("tr",[a("td",[t._v("metalsmith")]),t._v(" "),a("td",[t._v("静态网站生成器")])]),t._v(" "),a("tr",[a("td",[t._v("consolidate")]),t._v(" "),a("td",[t._v("consolidate是一个模板引擎的结合体。包括了常用的jade和ejs")])])])]),t._v(" "),a("p",[t._v("传送门"),a("a",{attrs:{href:"http://gitlab.work.java/frontend/template/zove",target:"_blank",rel:"noopener noreferrer"}},[t._v("脚手架"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"license"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#license"}},[t._v("#")]),t._v(" License")]),t._v(" "),a("p",[a("a",{attrs:{href:""}},[t._v("MIT")])]),t._v(" "),a("p",[t._v("Copyright (c) 2022-present Kane Xu")])])}),[],!1,null,null,null);a.default=s.exports}}]);